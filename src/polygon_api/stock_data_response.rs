use serde::{Serialize, Deserialize};


//Response of what we recieve from Polygon.io after we've cleaned and formatted i
#[derive(Debug, Deserialize, PartialEq)]
pub struct PriceDatum{
    pub high: f64,
    pub low: f64,
    pub close: f64,
    pub open: f64,
    pub volume: u64,
    pub timestamp: u64,
}


/**
 * Sample entry
 * {
 * 'ticker': 'TQQQ',
 * 'queryCount': 51,
 * 'resultsCount': 51,
 * 'adjusted': True,
 * 'results': [
 *     {'v': 3415680.0, 'vw': 0.4254, 'o': 0.4069, 'c': 0.4326, 'h': 0.4349, 'l': 0.4056, 't': 1265864400000, 'n': 120},
 *     {'v': 8520960.0, 'vw': 0.4289, 'o': 0.4208, 'c': 0.4344, 'h': 0.4381, 'l': 0.4184, 't': 1265950800000, 'n': 344}, {'v': 9615744.0, 'vw': 0.4447, 'o': 0.4446, 'c': 0.4512, 'h': 0.4522, 'l': 0.4376, 't': 1266296400000, 'n': 349}, {'v': 19138176.0, 'vw': 0.4557, 'o': 0.4572, 'c': 0.4588, 'h': 0.459, 'l': 0.4503, 't': 1266382800000, 'n': 606}, {'v': 38866560.0, 'vw': 0.4627, 'o': 0.4584, 'c': 0.4675, 'h': 0.4703, 'l': 0.4556, 't': 1266469200000, 'n': 1503}, {'v': 46480896.0, 'vw': 0.4667, 'o': 0.4644, 'c': 0.4675, 'h': 0.4736, 'l': 0.4608, 't': 1266555600000, 'n': 1355}, {'v': 25501632.0, 'vw': 0.4641, 'o': 0.4731, 'c': 0.4643, 'h': 0.4731, 'l': 0.459, 't': 1266814800000, 'n': 932}, {'v': 41077632.0, 'vw': 0.4486, 'o': 0.4617, 'c': 0.4461, 'h': 0.4642, 'l': 0.44, 't': 1266901200000, 'n': 1407}, {'v': 35272704.0, 'vw': 0.4596, 'o': 0.454, 'c': 0.4596, 'h': 0.4649, 'l': 0.4516, 't': 1266987600000, 'n': 1177}, {'v': 45479232.0, 'vw': 0.4461, 'o': 0.4449, 'c': 0.4594, 'h': 0.4625, 'l': 0.436, 't': 1267074000000, 'n': 1323}, {'v': 28801728.0, 'vw': 0.4618, 'o': 0.458, 'c': 0.4651, 'h': 0.467, 'l': 0.4535, 't': 1267160400000, 'n': 953}, {'v': 14226240.0, 'vw': 0.48, 'o': 0.471, 'c': 0.485, 'h': 0.487, 'l': 0.471, 't': 1267419600000, 'n': 490}, {'v': 24221952.0, 'vw': 0.4918, 'o': 0.4893, 'c': 0.488, 'h': 0.4985, 'l': 0.4867, 't': 1267506000000, 'n': 738}, {'v': 23977536.0, 'vw': 0.4919, 'o': 0.4934, 'c': 0.4907, 'h': 0.4977, 'l': 0.4859, 't': 1267592400000, 'n': 716}, {'v': 14738496.0, 'vw': 0.4915, 'o': 0.4924, 'c': 0.4961, 'h': 0.4968, 'l': 0.4847, 't': 1267678800000, 'n': 445}, {'v': 13431360.0, 'vw': 0.5126, 'o': 0.5067, 'c': 0.518, 'h': 0.5203, 'l': 0.504, 't': 1267765200000, 'n': 487}, {'v': 12668928.0, 'vw': 0.5216, 'o': 0.5185, 'c': 0.5208, 'h': 0.5245, 'l': 0.5185, 't': 1268024400000, 'n': 407}, {'v': 23208384.0, 'vw': 0.5311, 'o': 0.5179, 'c': 0.53, 'h': 0.5381, 'l': 0.5175, 't': 1268110800000, 'n': 785}, {'v': 20027520.0, 'vw': 0.5405, 'o': 0.5307, 'c': 0.543, 'h': 0.5462, 'l': 0.5304, 't': 1268197200000, 'n': 724}, {'v': 26957184.0, 'vw': 0.5419, 'o': 0.5397, 'c': 0.548, 'h': 0.5487, 'l': 0.5361, 't': 1268283600000, 'n': 858}, {'v': 18057024.0, 'vw': 0.5488, 'o': 0.554, 'c': 0.5492, 'h': 0.554, 'l': 0.5429, 't': 1268370000000, 'n': 647}, {'v': 21183360.0, 'vw': 0.5413, 'o': 0.5456, 'c': 0.5455, 'h': 0.5493, 'l': 0.5339, 't': 1268625600000, 'n': 677}, {'v': 23296704.0, 'vw': 0.5517, 'o': 0.5508, 'c': 0.5558, 'h': 0.5574, 'l': 0.5452, 't': 1268712000000, 'n': 796}, {'v': 19896960.0, 'vw': 0.561, 'o': 0.5574, 'c': 0.5597, 'h': 0.5676, 'l': 0.555, 't': 1268798400000, 'n': 653}, {'v': 26187264.0, 'vw': 0.5627, 'o': 0.5616, 'c': 0.5654, 'h': 0.5671, 'l': 0.5579, 't': 1268884800000, 'n': 949}, {'v': 20009472.0, 'vw': 0.5569, 'o': 0.5715, 'c': 0.5554, 'h': 0.5715, 'l': 0.5494, 't': 1268971200000, 'n': 636}, {'v': 29396736.0, 'vw': 0.5659, 'o': 0.5488, 'c': 0.5704, 'h': 0.577, 'l': 0.5468, 't': 1269230400000, 'n': 917}, {'v': 27649344.0, 'vw': 0.5739, 'o': 0.5743, 'c': 0.5823, 'h': 0.5835, 'l': 0.5654, 't': 1269316800000, 'n': 857}, {'v': 44607552.0, 'vw': 0.5746, 'o': 0.5782, 'c': 0.574, 'h': 0.5794, 'l': 0.5704, 't': 1269403200000, 'n': 1401}, {'v': 46958016.0, 'vw': 0.5847, 'o': 0.588, 'c': 0.5704, 'h': 0.5942, 'l': 0.5699, 't': 1269489600000, 'n': 1505}, {'v': 42138816.0, 'vw': 0.5728, 'o': 0.5785, 'c': 0.5734, 'h': 0.5844, 'l': 0.5644, 't': 1269576000000, 'n': 1297}, {'v': 19019328.0, 'vw': 0.5823, 'o': 0.582, 'c': 0.5812, 'h': 0.5871, 'l': 0.577, 't': 1269835200000, 'n': 649}, {'v': 19942080.0, 'vw': 0.5847, 'o': 0.586, 'c': 0.5873, 'h': 0.5924, 'l': 0.5754, 't': 1269921600000, 'n': 643}, {'v': 29764224.0, 'vw': 0.5821, 'o': 0.5808, 'c': 0.5794, 'h': 0.5886, 'l': 0.5754, 't': 1270008000000, 'n': 922}, {'v': 58299840.0, 'vw': 0.5813, 'o': 0.5859, 'c': 0.5783, 'h': 0.5971, 'l': 0.5653, 't': 1270094400000, 'n': 1777}, {'v': 33778368.0, 'vw': 0.5914, 'o': 0.5825, 'c': 0.595, 'h': 0.5985, 'l': 0.5782, 't': 1270440000000, 'n': 1197}, {'v': 29364864.0, 'vw': 0.5955, 'o': 0.5905, 'c': 0.5995, 'h': 0.6049, 'l': 0.5867, 't': 1270526400000, 'n': 1026}, {'v': 53112000.0, 'vw': 0.5957, 'o': 0.5975, 'c': 0.5961, 'h': 0.604, 'l': 0.5857, 't': 1270612800000, 'n': 1911}, {'v': 34822656.0, 'vw': 0.5913, 'o': 0.5901, 'c': 0.5982, 'h': 0.6017, 'l': 0.5811, 't': 1270699200000, 'n': 1149}, {'v': 29038848.0, 'vw': 0.6029, 'o': 0.6002, 'c': 0.6091, 'h': 0.6105, 'l': 0.5956, 't': 1270785600000, 'n': 1018}, {'v': 24399360.0, 'vw': 0.6124, 'o': 0.6111, 'c': 0.6115, 'h': 0.6162, 'l': 0.6071, 't': 1271044800000, 'n': 901}, {'v': 33614784.0, 'vw': 0.6135, 'o': 0.6095, 'c': 0.6207, 'h': 0.6217, 'l': 0.604, 't': 1271131200000, 'n': 1131}, {'v': 30547200.0, 'vw': 0.6337, 'o': 0.6296, 'c': 0.6426, 'h': 0.6431, 'l': 0.6283, 't': 1271217600000, 'n': 1187}, {'v': 22884288.0, 'vw': 0.6481, 'o': 0.6419, 'c': 0.6512, 'h': 0.6536, 'l': 0.6413, 't': 1271304000000, 'n': 791}, {'v': 64739520.0, 'vw': 0.633, 'o': 0.6443, 'c': 0.628, 'h': 0.6506, 'l': 0.6159, 't': 1271390400000, 'n': 2278}, {'v': 56365824.0, 'vw': 0.6201, 'o': 0.6221, 'c': 0.627, 'h': 0.6328, 'l': 0.6042, 't': 1271649600000, 'n': 2129}, {'v': 28225152.0, 'vw': 0.6347, 'o': 0.6368, 'c': 0.6363, 'h': 0.6407, 'l': 0.6248, 't': 1271736000000, 'n': 1000}, {'v': 42009408.0, 'vw': 0.6442, 'o': 0.6492, 'c': 0.6475, 'h': 0.653, 'l': 0.6355, 't': 1271822400000, 'n': 1361}, {'v': 61420032.0, 'vw': 0.6361, 'o': 0.6286, 'c': 0.6571, 'h': 0.6592, 'l': 0.6179, 't': 1271908800000, 'n': 2192}, {'v': 41173248.0, 'vw': 0.6592, 'o': 0.6577, 'c': 0.6657, 'h': 0.6678, 'l': 0.6499, 't': 1271995200000, 'n': 1550}, {'v': 40266816.0, 'vw': 0.6642, 'o': 0.6662, 'c': 0.6608, 'h': 0.6712, 'l': 0.6576, 't': 1272254400000, 'n': 1373}],
 *  'status': 'OK',
 * 'request_id': '636cf5fad9c8eecd90551482447e4171',
 *  'count': 51
 * }
 *
*/

#[derive(Serialize, Deserialize, Debug)]
pub struct StockEntry {
    pub v: f32,  // volume
    pub vw: f64, // volume weighted average price
    pub o: f64,  // open price
    pub c: f64,  // close price
    pub h: f64,  // high price
    pub l: f64,  // low price
    pub t: u64,  // timestamp in milliseconds
    pub n: u32,  // number of trades
}

#[derive(Serialize, Deserialize, Debug)]
#[allow(non_snake_case)]
pub struct PolygonResponse {
    pub ticker: String,
    pub queryCount: u32,
    pub resultsCount: u32,
    pub adjusted: bool,
    pub results: Option<Vec<StockEntry>>,
    pub status: String,
    pub request_id: String,
    pub count: u32,
}
